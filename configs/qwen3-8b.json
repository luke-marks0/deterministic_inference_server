{
  "schema_version": 1,
  "kind": "vllm.deterministic_inference_manifest",
  "metadata": {
    "name": "qwen3-8b",
    "description": "Spec-aligned deterministic manifest for Qwen3-8B.",
    "created_at": "2026-02-20T06:35:45Z",
    "owners": [
      "ml-platform@example.com"
    ]
  },
  "determinism": {
    "strict_hardware": false,
    "compare": {
      "tokens": {
        "rule": "exact"
      },
      "logits": {
        "rule": "exact"
      },
      "activations": {
        "rule": "absrel",
        "atol": 0.0,
        "rtol": 0.0
      },
      "engine_trace": {
        "rule": "exact"
      }
    }
  },
  "hardware": {
    "constraints": {
      "accelerator_vendor": "nvidia",
      "gpu_arch_min_cc": "8.0",
      "allowed_gpu_models": []
    },
    "record": {
      "capture_collect_env": true,
      "capture_nvidia_smi": true,
      "capture_driver_versions": true,
      "capture_pcie_topology": false
    }
  },
  "artifacts": {
    "store": {
      "type": "cas",
      "path": "state/store"
    },
    "lockfile": "manifests/qwen3-8b/manifest.lock.json"
  },
  "software_stack": {
    "python": {
      "version": "3.11.8",
      "packages": [
        {
          "name": "vllm",
          "source": {
            "type": "wheel",
            "digest": "97ff5ba0c359962f3d12625d286990614fb33e122568012992d2e623165a5f8b"
          }
        },
        {
          "name": "torch",
          "source": {
            "type": "wheel",
            "digest": "11ffd779e02064e548a470e03c44ea1abf964dbea1e52f79241617c25faf3937"
          }
        },
        {
          "name": "triton",
          "source": {
            "type": "wheel",
            "digest": "f57d52ad61f69302c692c028da244ef32828fdf14dc711b657ce8a4db7495cc3"
          }
        }
      ]
    },
    "compiled_extensions": []
  },
  "cuda_stack": {
    "userspace": {
      "cuda_toolkit": {
        "version": "12.x",
        "digest": "621e155eb77a75e6f2c4d4cf65177ffd2aa9a2625712443bc35657dc48bc141e"
      },
      "cublas": {
        "version": "12.x",
        "digest": "7b42da2c381b1945ab964ab47d5e3eb55c68e5bfe9713adc2a34ff8ad58f3827"
      },
      "cudnn": {
        "version": "9.x",
        "digest": "1218bedb143a5ce463ea551e7530e9c3dd803364b130439b4c182e1aaa5dfa4d"
      },
      "nccl": {
        "version": "2.x",
        "digest": "c12e64d2c825bbe6b87b17a77c8ecd78e9bdc7126a38867a878e690478ca56e0"
      }
    },
    "env": {
      "CUBLAS_WORKSPACE_CONFIG": ":4096:8",
      "CUDA_DEVICE_ORDER": "PCI_BUS_ID",
      "CUDA_VISIBLE_DEVICES": "0"
    },
    "driver_policy": "pinned_or_recorded"
  },
  "runtime": {
    "env": {
      "PYTHONHASHSEED": "0",
      "OMP_NUM_THREADS": "1",
      "MKL_NUM_THREADS": "1"
    },
    "locale": {
      "lang": "C.UTF-8",
      "tz": "UTC"
    },
    "threads": {
      "omp_num_threads": 1,
      "mkl_num_threads": 1
    },
    "network_policy": "online_allowed",
    "execution": {
      "backend": "openai_compatible",
      "base_url": "http://127.0.0.1:8003",
      "timeout_seconds": 600,
      "deterministic_failure_policy": "warn_only",
      "vllm_image": "docker.io/vllm/vllm-openai@sha256:8c9aaddfa6011b9651d06834d2fb90bdb9ab6ced4b420ec76925024eb12b22d0"
    }
  },
  "vllm": {
    "mode": "server",
    "reproducibility": {
      "enable_batch_invariance": true,
      "enable_v1_multiprocessing": false
    },
    "env": {
      "VLLM_BATCH_INVARIANT": "1",
      "VLLM_ENABLE_V1_MULTIPROCESSING": "0"
    },
    "engine_args": {
      "model": "Qwen/Qwen3-8B",
      "trust_remote_code": false,
      "dtype": "float16",
      "tensor_parallel_size": 1,
      "pipeline_parallel_size": 1,
      "max_model_len": 32768
    }
  },
  "model": {
    "weights": {
      "source": {
        "type": "huggingface",
        "repo": "Qwen/Qwen3-8B",
        "revision": "b968826d9c46dd6066d109eabc6255188de91218"
      },
      "files": [
        {
          "path": "model.safetensors",
          "digest": "6d67fd12dafdb9d928b5da454384bfbfd0095e54afa1b621ff0208c995940e11"
        }
      ]
    },
    "tokenizer": {
      "files": [
        {
          "path": "tokenizer.json",
          "digest": "bcc429baf1c5e496f99aaf8c4454e619ac8f835b01b38d5888a384e8e35e5295"
        },
        {
          "path": "tokenizer_config.json",
          "digest": "4a23d8e3b29e162601639a8ff4c4c06b764d3ed96bd6b43bdef6c9a141d08eb8"
        },
        {
          "path": "special_tokens_map.json",
          "digest": "81dfae9254a822e5ff39be6799fe50544f8f8e206b9007df2c93a12e015ff5f2"
        }
      ]
    },
    "config": {
      "files": [
        {
          "path": "config.json",
          "digest": "808d3c873f406c575a82e048e2b733f45774acfbb2e9945cd59d0af2ee0c767d"
        },
        {
          "path": "generation_config.json",
          "digest": "598cf408684bec75e680bba16fae37cbb0e9ce77c5810cf21e176e167e232686"
        }
      ]
    },
    "chat_template": {
      "file": {
        "path": "chat_template.jinja",
        "digest": "fd3b959fe7303d318ca11541d96ab21def8218a1a4c9a9decbe7e53bb89aaebf"
      }
    }
  },
  "inference": {
    "n_prompts": 100,
    "request_template": {
      "kind": "completion",
      "sampling": {
        "temperature": 0.0,
        "top_p": 0.95,
        "top_k": 50,
        "max_tokens": 32,
        "seed": 424242
      },
      "stop": {
        "sequences": [],
        "token_ids": []
      }
    },
    "batching": {
      "policy": "fixed",
      "schedule": "batch_invariant",
      "max_num_seqs": 1,
      "max_num_batched_tokens": 4096,
      "fixed_request_order": true,
      "concurrency": 1
    }
  },
  "capture": {
    "tokens": true,
    "logits": {
      "enabled": false,
      "scope": "chosen_only",
      "dtype": "float16",
      "capture_prefill": false,
      "capture_decode": false
    },
    "activations": {
      "enabled": false,
      "hooks": []
    },
    "engine_trace": {
      "enabled": false,
      "events": []
    }
  },
  "outputs": {
    "directory": "runs/qwen3-8b/${run_id}",
    "golden": {
      "enabled": false
    },
    "bundle_policy": {
      "include": [
        "manifest",
        "lock",
        "tokens",
        "run_log"
      ],
      "retention_days": 30
    }
  }
}
